---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead
			title="RSS"
			description="Subscribe to cbug.dev updates via RSS."
		/>
		<style>
			.panel {
				margin-top: 1.5rem;
				padding: 1.25rem 1.25rem 1.1rem;
				border: 1px solid var(--border);
				background: var(--surface);
			}

			.panel h1 {
				margin-bottom: 0.5rem;
			}

			.panel p {
				margin: 0 0 1rem;
			}

			.feed-row {
				display: flex;
				align-items: center;
				gap: 0.75rem;
				flex-wrap: wrap;
			}

			.feed-url {
				font-family: var(--mono);
				font-size: 0.95rem;
				background: var(--code-bg);
				border: 1px solid var(--code-border);
				padding: 0.35rem 0.5rem;
				overflow-wrap: anywhere;
			}

			.copy-button {
				border: 1px solid var(--border);
				background: transparent;
				color: var(--text-primary);
				font-family: var(--mono);
				font-size: 0.85rem;
				padding: 0.35rem 0.6rem;
				cursor: pointer;
				transition: color 140ms ease, border-color 140ms ease, background-color 140ms ease;
			}

			.copy-button:hover {
				color: var(--text-primary);
				border-color: var(--accent);
				background: var(--code-bg);
			}

			.note {
				color: var(--muted);
				font-size: 0.95rem;
			}

			@media (max-width: 520px) {
				.panel {
					padding: 1rem;
				}
				.feed-url {
					width: 100%;
				}
			}
		</style>
	</head>
	<body>
		<Header />
		<main>
			<section class="panel" aria-labelledby="rss-title">
				<h1 id="rss-title">RSS</h1>
				<p>
					RSS lets you subscribe to updates without social media or email. Add the feed
					URL below to any reader app (NetNewsWire, Feedly, Reeder, Inoreader).
				</p>
				<div class="feed-row">
					<span class="feed-url" data-rss-url>/rss.xml</span>
					<button class="copy-button" type="button" data-copy-rss>
						Copy feed URL
					</button>
				</div>
				<p class="note">
					If your app asks for the full address, use the site domain + `/rss.xml`.
				</p>
			</section>
		</main>
		<Footer />
		<script is:inline>
			(() => {
				const button = document.querySelector('[data-copy-rss]');
				const label = document.querySelector('[data-rss-url]');
				if (!button || !label) return;
				const path = '/rss.xml';
				const absolute = `${window.location.origin}${path}`;
				label.textContent = absolute;
				button.addEventListener('click', async () => {
					try {
						await navigator.clipboard.writeText(absolute);
						button.textContent = 'Copied';
						setTimeout(() => {
							button.textContent = 'Copy feed URL';
						}, 1200);
					} catch (error) {
						button.textContent = 'Copy failed';
						setTimeout(() => {
							button.textContent = 'Copy feed URL';
						}, 1200);
					}
				});
			})();
		</script>
	</body>
</html>
